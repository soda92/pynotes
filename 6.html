<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.10">
<title>笔记6</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment @import statement to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
:not(pre)>code.nobreak{word-wrap:normal}
:not(pre)>code.nowrap{white-space:nowrap}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details>summary:first-of-type{cursor:pointer;display:list-item;outline:none;margin-bottom:.75em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class="highlight"],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid currentColor;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid currentColor;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;text-align:left;margin-right:0}
table.tableblock{max-width:100%;border-collapse:separate}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
td.tableblock>.content>:last-child.sidebarblock{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot,table.frame-ends{border-width:1px 0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body class="article">
<div id="header">
</div>
<div id="content">
<div class="sect1">
<h2 id="_笔记6">笔记6</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_今日内容">今日内容：</h3>
<div class="ulist">
<ul>
<li>
<p>mysql数据库的基本操作</p>
</li>
<li>
<p>常用的sql语句</p>
</li>
<li>
<p>Python连接mysql数据库实现增删改查</p>
</li>
<li>
<p>Python操作Excel表格中的数据</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_一mysql数据库">一、mysql数据库</h3>
<div class="sect3">
<h4 id="_数据库的基本介绍">数据库的基本介绍</h4>

</div>
<div class="sect3">
<h4 id="_1_数据库的介绍">1.数据库的介绍</h4>
<div class="paragraph">
<p>数据库就是<strong>存储和管理数据的仓库</strong>，数据按照一定的格式进行存储，用户可以对数据库中的数据进行增加、修改、删除、查询等操作。</p>
</div>
</div>
<div class="sect3">
<h4 id="_2_数据库的分类">2. 数据库的分类</h4>
<div class="ulist">
<ul>
<li>
<p>关系型数据库</p>
</li>
<li>
<p>非关系型数据库</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>关系型数据库:</strong></p>
</div>
<div class="paragraph">
<p>是指采用了关系模型来组织数据的数据库，简单来说，<strong>关系模型指的就是二维表格模型</strong>，好比Excel文件中的表格，强调使用表格的方式存储数据。</p>
</div>
<div class="paragraph">
<p><strong>关系型数据库效果图:</strong></p>
</div>
<div class="paragraph">
<p><strong>关系型数据库中核心元素</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>数据行</p>
</li>
<li>
<p>数据列</p>
</li>
<li>
<p>数据表</p>
</li>
<li>
<p>数据库(数据表的集合)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>常用的关系型数据库:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Oracle</p>
</li>
<li>
<p>Microsoft SQL Server</p>
</li>
<li>
<p>MySQL</p>
</li>
<li>
<p>SQLite</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>非关系型数据库:</strong></p>
</div>
<div class="paragraph">
<p>非关系型数据库，又被称为NoSQL（Not Only SQL )，意为不仅仅是SQL，对NoSQL
最普遍的定义是``非关联型的''，强调 Key-Value 的方式存储数据。</p>
</div>
<div class="paragraph">
<p><strong>常用的非关系型数据库:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>MongoDB</p>
</li>
<li>
<p>Redis</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>提示:
目前我们先学习一下关系型数据库，而非关系型数据库会在后面课程中进行学习，大家先知道一下即可。</p>
</div>
</div>
<div class="sect3">
<h4 id="_3_数据库的作用">3. 数据库的作用</h4>
<div class="paragraph">
<p>数据库的作用就是存储和管理数据的，比如:
我们在京东网站上的浏览的商品列表数据，这些数据都会存储在数据库。</p>
</div>
<div class="paragraph">
<p><strong>用户浏览商品列表效果图:</strong></p>
</div>
</div>
<div class="sect3">
<h4 id="_4_数据库的特点">4. 数据库的特点</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>持久化存储</p>
</li>
<li>
<p>读写速度极高</p>
</li>
<li>
<p>保证数据的有效性</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_mysql数据库的安装及使用">mysql数据库的安装及使用</h4>
<div class="sect4">
<h5 id="_1_mysql数据库的介绍">1. MySQL数据库的介绍</h5>
<div class="paragraph">
<p>MySQL是一个关系型数据库管理系统，在 WEB 应用方面，MySQL是最好的 RDBMS
(Relational Database Management System，关系数据库管理系统)
应用软件，它是由瑞典MySQL AB 公司开发，目前属于 Oracle 旗下产品，MySQL
是最流行的关系型数据库管理系统中的一个。</p>
</div>
<div class="paragraph">
<p><strong>MySQL的特点:</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>MySQL是开源的，所以你不需要支付额外的费用。</p>
</li>
<li>
<p>MySQL支持大型的数据库。可以处理拥有上千万条记录的大型数据库。</p>
</li>
<li>
<p>MySQL使用标准的SQL数据语言形式。</p>
</li>
<li>
<p>MySQL可以安装在不同的操作系统，并且提供多种编程语言的操作接口。这些编程语言包括C、C++、Python、Java、Ruby等等。</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_2_mysql数据库的">2. MySQL数据库的</h5>
<div class="paragraph">
<p>借助安装的操作文档进行安装</p>
</div>
</div>
<div class="sect4">
<h5 id="_3_sql语句的介绍">3. SQL语句的介绍</h5>
<div class="paragraph">
<p>SQL(Structured Query
Language)是结构化查询语言，是一种用来操作RDBMS的数据库的语言。也就是说通过
SQL 可以操作 oracle,sql server,mysql,sqlite 等关系型的数据库。</p>
</div>
<div class="paragraph">
<p>SQL的作用是实现数据库客户端和数据库服务端之间的通信，SQL就是通信的桥梁。</p>
</div>
<div class="paragraph">
<p><strong>SQL语言主要分为：</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>DQL：数据查询语言，用于对数据进行查询，如select</strong></p>
</li>
<li>
<p><strong>DML：数据操作语言，对数据进行增加、修改、删除，如insert、update、delete</strong></p>
</li>
<li>
<p>TPL：事务处理语言，对事务进行处理，包括begin
transaction、commit、rollback</p>
</li>
<li>
<p>DCL：数据控制语言，进行授权与权限回收，如grant、revoke</p>
</li>
<li>
<p>DDL：数据定义语言，进行数据库、表的管理等，如create、drop</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>说明:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>对于程序员来讲，重点是数据的增、删、改、查，必须熟练编写DQL、DML，能够编写DDL完成数据库、表的操作，其它操作如TPL、DCL了解即可.</p>
</li>
<li>
<p>SQL语言不区分大小写</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_4_常用的sql语句介绍">4.常用的sql语句介绍</h5>
<div class="ulist">
<ul>
<li>
<p>能够知道使用命令行连接数据库命令</p>
</li>
<li>
<p>能够写出增、删、改、查的SQL语句</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_登录和登出数据库">登录和登出数据库</h5>
<div class="paragraph">
<p><strong>登录数据库:</strong></p>
</div>
<div class="paragraph">
<p>输入下面命令:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">mysql -uroot -p</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>说明:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>-u 后面是登录的用户名</p>
</li>
<li>
<p>-p 后面是登录密码, 如果不填写, 回车之后会提示输入密码</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>登录成功后, 输入如下命令查看效果：</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql"># 显示当前时间
select now();</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>登出(退出)数据库:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">quit 或 exit 或 ctrl + Z</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_数据库操作的sql语句">数据库操作的SQL语句</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>查看所有数据库</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">show databases;</code></pre>
</div>
</div>
</li>
<li>
<p>创建数据库</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">create database 数据库名 charset=utf8;
例：
create database python charset=utf8;</code></pre>
</div>
</div>
</li>
<li>
<p>使用数据库</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">use 数据库名;</code></pre>
</div>
</div>
</li>
<li>
<p>查看当前使用的数据库</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">select database();</code></pre>
</div>
</div>
</li>
<li>
<p>删除数据库-慎重</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">drop database 数据库名;
例：
drop database python;</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_表结构操作的sql语句">表结构操作的SQL语句</h4>
<div class="sect4">
<h5 id="_数据类型和约束">数据类型和约束</h5>
<div class="paragraph">
<p>大家都知道数据库中的数据保存在数据表中，在表中为了更加准确的存储数据，保证数据的正确有效，可以在创建表的时候，为表添加一些强制性的验证，比如:数据类型和约束。</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_数据类型">数据类型</h4>
<div class="paragraph">
<p>数据类型是指在创建表的时候为表中字段指定数据类型，只有数据符合类型要求才能存储起来，使用数据类型的原则是:够用就行，尽量使用取值范围小的，而不用大的，这样可以更多的节省存储空间。</p>
</div>
<div class="paragraph">
<p><strong>常用数据类型如下:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>整数：int，bit</p>
</li>
<li>
<p>小数：decimal</p>
</li>
<li>
<p>字符串：varchar,char</p>
</li>
<li>
<p>日期时间: date, time, datetime</p>
</li>
<li>
<p>枚举类型(enum)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>数据类型说明:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>decimal表示浮点数，如 decimal(5, 2) 表示共存5位数，小数占 2 位.</p>
</li>
<li>
<p>char表示固定长度的字符串，如char(3)，如果填充’ab’时会补一个空格为’ab
’，3表示字符数</p>
</li>
<li>
<p>varchar表示可变长度的字符串，如varchar(3)，填充’ab’时就会存储’ab’，3表示字符数</p>
</li>
<li>
<p>对于图片、音频、视频等文件，不存储在数据库中，而是上传到某个服务器上，然后在表中存储这个文件的保存路径.</p>
</li>
<li>
<p>字符串 text 表示存储大文本，当字符大于 4000 时推荐使用, 比如技术博客.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_数据约束">数据约束</h4>
<div class="paragraph">
<p>约束是指数据在数据类型限定的基础上额外增加的要求.</p>
</div>
<div class="paragraph">
<p><strong>常见的约束如下:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>主键 primary key: 物理上存储的顺序. MySQL 建议所有表的主键字段都叫 id,
类型为 int unsigned.</p>
</li>
<li>
<p>非空 not null: 此字段不允许填写空值.</p>
</li>
<li>
<p>惟一 unique: 此字段的值不允许重复.</p>
</li>
<li>
<p>默认 default: 当不填写字段对应的值会使用默认值，如果填写时以填写为准.</p>
</li>
<li>
<p>外键 foreign key: 对关系字段进行约束, 当为关系字段填写值时,
会到关联的表中查询此值是否存在, 如果存在则填写成功,
如果不存在则填写失败并抛出异常.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_数据类型附录表">数据类型附录表</h4>
<div class="sect4">
<h5 id="_1_整数类型">1. 整数类型</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 14%;">
<col style="width: 9%;">
<col style="width: 49%;">
<col style="width: 28%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">类型</th>
<th class="tableblock halign-left valign-top">字节大小</th>
<th class="tableblock halign-left valign-top">有符号范围(Signed)</th>
<th class="tableblock halign-left valign-top">无符号范围(Unsigned)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TINYINT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-128 ~ 127</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 ~ 255</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SMALLINT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-32768 ~ 32767</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 ~ 65535</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MEDIUMINT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-8388608 ~ 8388607</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 ~ 16777215</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">INT/INTEGER</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-2147483648 ~2147483647</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 ~ 4294967295</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BIGINT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-9223372036854775808 ~ 9223372036854775807</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 ~
18446744073709551615</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_2_字符串">2. 字符串</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">类型</th>
<th class="tableblock halign-left valign-top">说明</th>
<th class="tableblock halign-left valign-top">使用场景</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CHAR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">固定长度，小型数据</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">身份证号、手机号、电话、密码</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">VARCHAR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">可变长度，小型数据</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">姓名、地址、品牌、型号</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TEXT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">可变长度，字符个数大于 4000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">存储小型文章或者新闻</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LONGTEXT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">可变长度， 极大型文本数据</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">存储极大型文本数据</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_3_时间类型">3. 时间类型</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">类型</th>
<th class="tableblock halign-left valign-top">字节大小</th>
<th class="tableblock halign-left valign-top">示例</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DATE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">`2020-01-01'</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TIME</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">`12:29:59'</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DATETIME</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">`2020-01-01 12:29:59'</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">YEAR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">`2017'</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TIMESTAMP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">`1970-01-01 00:00:01' UTC ~ `2038-01-01 00:00:01' UTC</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_总结">总结</h4>
<div class="ulist">
<ul>
<li>
<p>常用的数据类型:</p>
<div class="ulist">
<ul>
<li>
<p>整数：int，bit</p>
</li>
<li>
<p>小数：decimal</p>
</li>
<li>
<p>字符串：varchar,char</p>
</li>
<li>
<p>日期时间: date, time, datetime</p>
</li>
<li>
<p>枚举类型(enum)</p>
</li>
</ul>
</div>
</li>
<li>
<p>常见的约束:</p>
<div class="ulist">
<ul>
<li>
<p>主键约束 primary key</p>
</li>
<li>
<p>非空约束 not null</p>
</li>
<li>
<p>惟一约束 unique</p>
</li>
<li>
<p>默认约束 default</p>
</li>
<li>
<p>外键约束 foreign key</p>
</li>
</ul>
</div>
</li>
<li>
<p>数据类型和约束保证了表中数据的准确性和完整性</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="_sql语句的具体操作">sql语句的具体操作</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>查看当前数据库中所有表</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">show tables;</code></pre>
</div>
</div>
</li>
<li>
<p>创建表</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">create table students(
 id int unsigned primary key auto_increment not null,
 name varchar(20) not null,
 age tinyint unsigned default 0,
 height decimal(5,2),
 gender enum('男','女','人妖','保密')
);</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>说明:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">create table 表名(
字段名称 数据类型  可选的约束条件,
column1 datatype contrai,
...
);</code></pre>
</div>
</div>
</li>
<li>
<p>修改表-添加字段</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">alter table 表名 add 列名 类型 约束;
例：
alter table students add birthday datetime;</code></pre>
</div>
</div>
</li>
<li>
<p>修改表-修改字段类型</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">alter table 表名 modify 列名 类型 约束;
例：
alter table students modify birthday date not null;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>说明:</strong>
* modify: 只能修改字段类型或者约束，不能修改字段名</p>
</div>
</li>
<li>
<p>修改表-修改字段名和字段类型</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">alter table 表名 change 原名 新名 类型及约束;
例：
alter table students change birthday birth datetime not null;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>说明:</strong>
* change: 既能对字段重命名又能修改字段类型还能修改约束</p>
</div>
</li>
<li>
<p>修改表-删除字段</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">alter table 表名 drop 列名;
例：
alter table students drop birthday;</code></pre>
</div>
</div>
</li>
<li>
<p>查看创表SQL语句</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">show create table 表名;
例：
show create table students;</code></pre>
</div>
</div>
</li>
<li>
<p>查看创库SQL语句</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">show create database 数据库名;
例：
show create database mytest;</code></pre>
</div>
</div>
</li>
<li>
<p>删除表</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">drop table 表名;
例：
drop table students;</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_表数据操作的sql语句">表数据操作的SQL语句</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>查询数据</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">-- 1. 查询所有列
select * from 表名;
例：
select * from students;
-- 2. 查询指定列
select 列1,列2,... from 表名;
例：
select id,name from students;</code></pre>
</div>
</div>
</li>
<li>
<p>添加数据</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">-- 1. 全列插入：值的顺序与表结构字段的顺序完全一一对应
insert into 表名 values (...)
例:
insert into students values(0, 'xx', default, default, '男');
-- 2. 部分列插入：值的顺序与给出的列顺序对应
insert into 表名 (列1,...) values(值1,...)
例:
insert into students(name, age) values('王二小', 15);
-- 3. 全列多行插入
insert into 表名 values(...),(...)...;
例:
insert into students values(0, '张飞', 55, 1.75, '男'),(0, '关羽', 58, 1.85, '男');
-- 4. 部分列多行插入
insert into 表名(列1,...) values(值1,...),(值1,...)...;
例：
insert into students(name, height) values('刘备', 1.75),('曹操', 1.6);</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>说明:</strong>
* 主键列是自动增长，但是在全列插入时需要占位，通常使用空值(0或者null或者default)
* 在全列插入时，如果字段列有默认值可以使用 default
来占位，插入后的数据就是之前设置的默认值</p>
</div>
</li>
<li>
<p>修改数据</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">update 表名 set 列1=值1,列2=值2... where 条件
例：
update students set age = 18, gender = '女' where id = 6;</code></pre>
</div>
</div>
</li>
<li>
<p>删除数据</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">delete from 表名 where 条件
例：
delete from students where id=5;</code></pre>
</div>
</div>
<div class="paragraph">
<p>问题:</p>
</div>
<div class="paragraph">
<p>上面的操作称之为物理删除，一旦删除就不容易恢复，我们可以使用逻辑删除的方式来解决这个问题。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">-- 添加删除表示字段，0表示未删除 1表示删除
alter table students add isdelete bit default 0;
-- 逻辑删除数据
update students set isdelete = 1 where id = 8;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>说明:</strong>
* 逻辑删除，本质就是修改操作</p>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_三pymysql的使用">三、PyMySQL的使用</h3>
<div class="sect3">
<h4 id="_1_安装pymysql第三方包">1.<strong>安装pymysql第三方包:</strong></h4>
<div class="literalblock">
<div class="content">
<pre>pip install --user pymysql</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_2_pymysql的使用"><strong>2.pymysql的使用:</strong></h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>导入 pymysql 包</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-py" data-lang="py"> import pymysql</code></pre>
</div>
</div>
</li>
<li>
<p>创建连接对象</p>
<div class="paragraph">
<p>调用pymysql模块中的connect()函数来创建连接对象,代码如下:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"> conn=connect(参数列表)

 * 参数host：连接的mysql主机，如果本机是'localhost'
 * 参数port：连接的mysql主机的端口，默认是3306
 * 参数user：连接的用户名
 * 参数password：连接的密码
 * 参数database：数据库的名称
 * 参数charset：通信采用的编码方式，推荐使用utf8</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>连接对象操作说明:</strong>
* 关闭连接 conn.close()
* 提交数据 conn.commit()
* 撤销数据 conn.rollback()</p>
</div>
</li>
<li>
<p>获取游标对象</p>
<div class="paragraph">
<p>获取游标对象的目标就是要执行sql语句，完成对数据库的增、删、改、查操作。代码如下:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-py" data-lang="py"> # 调用连接对象的cursor()方法获取游标对象
 cur =conn.cursor()</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>游标操作说明:</strong>
* 使用游标执行SQL语句: execute(operation [parameters ])
执行SQL语句，返回受影响的行数，主要用于执行insert、update、delete、select等语句
* 获取查询结果集中的一条数据:cur.fetchone()返回一个元组, 如 (1,`张三')
* 获取查询结果集中的所有数据:
cur.fetchall()返回一个元组,如1,`张三'),(2,`李四'
* 关闭游标: cur.close(),表示和数据库操作完成</p>
</div>
</li>
<li>
<p>pymysql完成数据的查询操作</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">import pymysql

# 创建连接对象
conn = pymysql.connect(host='localhost', port=3306, user='root', password='mysql',database='python', charset='utf8')

# 获取游标对象
cursor = conn.cursor()

# 查询 SQL 语句
sql = "select * from students;"
# 执行 SQL 语句 返回值就是 SQL 语句在执行过程中影响的行数
row_count = cursor.execute(sql)
print("SQL 语句执行影响的行数%d" % row_count)

# 取出结果集中一行数据,　例如:(1, '张三')
# print(cursor.fetchone())

# 取出结果集中的所有数据, 例如:((1, '张三'), (2, '李四'), (3, '王五'))
for line in cursor.fetchall():
    print(line)

# 关闭游标
cursor.close()

# 关闭连接
conn.close()</code></pre>
</div>
</div>
</li>
<li>
<p>pymysql完成对数据的增删改</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">import pymysql

# 创建连接对象
conn = pymysql.connect(host='localhost', port=3306, user='root', password='mysql',database='python', charset='utf8')

# 获取游标对象
cursor = conn.cursor()

try:
    # 添加 SQL 语句
    # sql = "insert into students(name) values('刘璐'), ('王美丽');"
    # 删除 SQ L语句
    # sql = "delete from students where id = 5;"
    # 修改 SQL 语句
    sql = "update students set name = '王铁蛋' where id = 6;"
    # 执行 SQL 语句
    row_count = cursor.execute(sql)
    print("SQL 语句执行影响的行数%d" % row_count)
    # 提交数据到数据库
    conn.commit()
except Exception as e:
    # 回滚数据， 即撤销刚刚的SQL语句操作
    conn.rollback()

# 关闭游标
cursor.close()

# 关闭连接
conn.close()</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>说明:</strong>
* conn.commit() 表示将修改操作提交到数据库
* conn.rollback() 表示回滚数据</p>
</div>
</li>
<li>
<p>防止SQL注入</p>
<div class="paragraph">
<p>什么是SQL注入?</p>
</div>
<div class="paragraph">
<p>用户提交带有恶意的数据与SQL语句进行字符串方式的拼接，从而影响了SQL语句的语义，最终产生数据泄露的现象。</p>
</div>
<div class="paragraph">
<p>如何防止SQL注入?</p>
</div>
<div class="paragraph">
<p>SQL语句参数化
* SQL语言中的参数使用%s来占位，此处不是python中的字符串格式化操作
* 将SQL语句中%s占位所需要的参数存在一个列表中，把参数列表传递给execute方法中第二个参数</p>
</div>
<div class="paragraph">
<p>+
<strong>防止SQL注入的示例代码:</strong></p>
</div>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">from pymysql import connect

def main():

    find_name = input("请输入物品名称：")

    # 创建Connection连接
    conn = connect(host='localhost',port=3306,user='root',password='mysql',database='jing_dong',charset='utf8')
    # 获得Cursor对象
    cs1 = conn.cursor()

    # 非安全的方式
    # 输入 ' or 1 = 1 or '   (单引号也要输入)
    # sql = "select * from goods where name='%s'" % find_name
    # print("""sql===&gt;%s&lt;====""" % sql)
    # # 执行select语句，并返回受影响的行数：查询所有数据
    # count = cs1.execute(sql)

    # 安全的方式
    # 构造参数列表
    params = [find_name]
    # 执行select语句，并返回受影响的行数：查询所有数据
    count = cs1.execute("select * from goods where name=%s", params)
    # 注意：
    # 如果要是有多个参数，需要进行参数化
    # 那么params = [数值1, 数值2....]，此时sql语句中有多个%s即可
    # %s 不需要带引号

    # 打印受影响的行数
    print(count)
    # 获取查询的结果
    # result = cs1.fetchone()
    result = cs1.fetchall()
    # 打印查询的结果
    print(result)
    # 关闭Cursor对象
    cs1.close()
    # 关闭Connection对象
    conn.close()

if __name__ == '__main__':
    main()</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>说明:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>execute方法中的 %s 占位不需要带引号</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_四excel表格的操作">四、Excel表格的操作</h3>
<div class="sect3">
<h4 id="_学习目标">学习目标</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>使用python代码读取excel表格中内容并绘制图表</p>
</li>
<li>
<p>使用python向excel中写入数据</p>
</li>
<li>
<p>excel与数据库的联合操作</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_读取excel数据">读取excel数据</h4>
<div class="paragraph">
<p>Python完成读取excel表格中的数据步骤：</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>安装xlrd模块</p>
</li>
<li>
<p>导入模块xlrd</p>
</li>
<li>
<p>打开excel表格，获取workbook对象</p>
</li>
<li>
<p>获取excel中的sheet工作表对象</p>
</li>
<li>
<p>进行读写操作</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>具体代码实现：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">import xlrd
from pyecharts.charts import Bar

# Python读取excel中的数据
# 借助xlrd模块读取excel表格中的数据

# 1.打开excel表格
# 2.获取excel表格中的工作表sheet
# 3.获取sheet中的数据，行或者列
# 4.读取相关的内容
# 5.借助echarts模块绘制可视化大图
excel_book = xlrd.open_workbook("employee.xlsx")
print(excel_book)
# 获取excel表中的工作表,获取其中某一个工作表
excel_sheet = excel_book.sheets()[0]
print(excel_sheet)

# 获取sheet工作表中的行和列
# 获取行数
print(excel_sheet.nrows)
# 获取列的数量
print(excel_sheet.ncols)
# 获取其中某一行或者某一列的值,从0开始
print(excel_sheet.row_values(1))
print(excel_sheet.col_values(2))

# 使用for循环获取所有行的数据
# for row in range(0,21):
#     print(excel_sheet.row_values(row))

# for row in range(1,excel_sheet.nrows):
#     print(excel_sheet.row_values(row))

# 需求：想只获取姓名并且获取其对应的销售业绩
names = []
sales = []
for row in range(1,excel_sheet.nrows):
    # 遍历时获取每一个姓名，追加到姓名列表
    name = excel_sheet.row_values(row)[0]
    names.append(name)
    # 遍历时获取每一个销售业绩，追加到销售业绩列表
    sale = excel_sheet.row_values(row)[2]
    sales.append(sale)

print(names)
print(sales)

# 根据姓名和销售业绩绘制柱状图，姓名是x轴，销售业绩是y轴
# 创建柱状图对象
bar = Bar()
# 添加x和y
bar.add_xaxis(names)
bar.add_yaxis("当月销售额表",sales)
bar.render("销售情况.html")</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_写入excel数据">写入excel数据</h4>
<div class="paragraph">
<p>向excel表中写入数据的步骤：</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>下载xlwt或者xlsxwriter模块</p>
</li>
<li>
<p>导入模块xlsxwriter</p>
</li>
<li>
<p>打开excel表格，并且获取excel对象</p>
</li>
<li>
<p>获取工作表sheet</p>
</li>
<li>
<p>执行写入操作</p>
</li>
<li>
<p>关闭工作表</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>具体代码实现：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># 向excel中写入数据
# xlwt可以实现写入数据到excel表格
# xlsxwriter也可以实现写入数据到excel表格，不过功能更加强大
import xlsxwriter

# 获取要写入数据的excel对象
excel_book = xlsxwriter.Workbook("stus.xlsx")
# 添加一个工作表
work_sheet = excel_book.add_worksheet()
# 设置当前工作表以及附带的格式
work_sheet.write("A1","学号")
work_sheet.write("B1","姓名")
work_sheet.write("C1","年龄")
work_sheet.write("D1","成绩")
# 设置工作表中添加数据的行和列
row = 1
col = 0
stus_list = [("0001","张三",18,92),("0002","李四",19,90),("0003","如花",18,88),("0004","似玉",19,85)]
# 通过遍历的方式写入数据到excel
for id,name,age,score in stus_list:
    work_sheet.write(row, col, id)
    work_sheet.write(row, col+1, name)
    work_sheet.write(row, col+2, age)
    work_sheet.write(row, col+3, score)
    # 每写完一行数据row+1
    row += 1

excel_book.close()</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="_mysql数据写入到excel">mysql数据写入到excel</h5>
<div class="paragraph">
<p>把mysql中的数据读取后，写入到excel表格</p>
</div>
<div class="paragraph">
<p>实现步骤：</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>获取数据库连接</p>
</li>
<li>
<p>读取数据中的数据封装到list</p>
</li>
<li>
<p>把获取到的数据写入excel</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>具体的代码实现</p>
</div>
<div class="paragraph">
<p>获取数据库连接</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">import pymysql

# 获取连接
def get_conn():
    conn = pymysql.connect(host="localhost",port=3306,
                           user="root",password="root",
                           database="stus",charset="utf8")
    cursor = conn.cursor()

    return conn,cursor

# 断开连接
def close_conn(conn,cursor):
    cursor.close()
    conn.close()</code></pre>
</div>
</div>
<div class="paragraph">
<p>实现数据的读写操作</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># 从数据库到excel表格数据的操作
from day05.rt_03_data_utils import *
import xlsxwriter
# 从数据库读取数据到列表
def get_data():
    # 获取数据库连接和cursor对象
    conn, cursor = get_conn()
    # 获取数据表中的所有数据
    sql = "select * from stu_info"
    # 执行查询语句
    count = cursor.execute(sql)
    # 获取具体查询后的数据
    tuple_datas = cursor.fetchall()
    print(tuple_datas)
    list_datas = list(tuple_datas)
    list_new = []
    # list_data = []
    for data in list_datas:
        data = list(data)
        # list_data.append(data[0])
        # list_data.append(data[1])
        # list_data.append(data[2])
        list_new.append(data)
    print(list_new)
    return list_new


# 把数据写入excel表格
def write_to_excel(lists):
    # 创建一个excel文档
    workbook = xlsxwriter.Workbook("datas.xlsx")
    # 添加一个工作表
    worksheet = workbook.add_worksheet()

    # 设置单元表格的表头以及附带的格式
    worksheet.write("A1", "学号")
    worksheet.write("B1", "姓名")
    worksheet.write("C1", "年龄")
    worksheet.write("D1", "班级")
    worksheet.write("E1", "成绩")

    # 设置工作表中的行和列
    row, col = 1, 0
    # 开始添加数据
    for id,sid,name,age,classes,score in lists:
        # 把数据放入行列
        worksheet.write(row, col, sid)
        worksheet.write(row, col + 1, name)
        worksheet.write(row, col + 2, age)
        worksheet.write(row, col + 3, classes)
        worksheet.write(row, col + 4, score)
        # 每遍历一条数据行增加1
        row += 1

    workbook.close()


if __name__ == '__main__':

    write_to_excel(get_data())</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</body>
</html>